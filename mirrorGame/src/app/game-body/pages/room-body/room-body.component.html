<app-wait-the-player
  [playerCanPlay]="!playerCanPlay"
  *ngIf="roomInfo?.usersId.length == 4 && canStartTheGame"
></app-wait-the-player>
<app-say-mirror
  *ngIf="canStartTheGame"
  [gameId]="gameId"
  [roomName]="roomName"
  [playersIndex]="playersIndex"
></app-say-mirror>
<app-results
  style="position: fixed; z-index: 100; width: 100%"
  [Results]="showTheResult"
  (theWinner)="gettheWinner($event)"
></app-results>
<div
  class="room-body"
  style="height: 100vh"
  *ngIf="roomInfo?.usersId.length == 4 && canStartTheGame"
>
  <div class="d-flex justify-content-around first-line">
    <div class=""></div>
    <div class="mt-4">
      <app-player
        [playersInfo]="playersInfo"
        *ngIf="
          daynamicPlayer[
            (playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4
          ]
        "
        [playerCard]="
          daynamicPlayer[
            (playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4
          ].playerCards
        "
        [playerNumber]="
          daynamicPlayer[
            (playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4
          ].number
        "
        [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
        [showPlayerCards]="showPlayerCards"
        [takeAndGive]="takeAndGive"
        [showFourPlayerCards]="showFourPlayerCards"
        (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
        (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
        (updateTheCards)="updateTheCards($event)"
        [counterUpdatedForPlayers]="updateCounterForPlayers"
        (updateCounterForPlayers)="updateCounter($event)"
        (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
      ></app-player>
    </div>
    <div class=""></div>
  </div>
  <div class="d-flex justify-content-between first-line">
    <div class="ml-3">
      <app-player
        [playersInfo]="playersInfo"
        *ngIf="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ]
        "
        [playerCard]="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ].playerCards
        "
        [playerNumber]="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ].number
        "
        [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
        [showPlayerCards]="showPlayerCards"
        [takeAndGive]="takeAndGive"
        [showFourPlayerCards]="showFourPlayerCards"
        (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
        (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
        (updateTheCards)="updateTheCards($event)"
        [counterUpdatedForPlayers]="updateCounterForPlayers"
        (updateCounterForPlayers)="updateCounter($event)"
        (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
      ></app-player>
    </div>
    <div class="">
      <app-table-cards
        [Cards]="tableCards"
        [hideTheButton]="hideTheButton"
        (canPullFromGround)="canPullFromGround($event)"
      ></app-table-cards>
    </div>
    <div class="mr-3">
      <app-player
        [playersInfo]="playersInfo"
        *ngIf="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ]
        "
        [playerCard]="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ].playerCards
        "
        [playerNumber]="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ].number
        "
        [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
        [showPlayerCards]="showPlayerCards"
        [takeAndGive]="takeAndGive"
        [showFourPlayerCards]="showFourPlayerCards"
        (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
        (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
        (updateTheCards)="updateTheCards($event)"
        [counterUpdatedForPlayers]="updateCounterForPlayers"
        (updateCounterForPlayers)="updateCounter($event)"
        (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
      ></app-player>
    </div>
  </div>
  <div class="d-flex justify-content-around first-line">
    <div class="">
      <app-pull-cards
        [Cards]="pullCards"
        [gameId]="gameId"
        [roomName]="roomName"
        [hideTheCard]="hideTheCard"
        (canPullFromPullCards)="canPullFromPullCards($event)"
        (selectedCard)="theSelectedCard($event)"
      ></app-pull-cards>
    </div>
    <div class="">
      <app-main-player
        [playerName]="playersInfo[playersIndex - 1]?.name"
        [allPullCards]="pullCards"
        [Cards]="playerCards"
        [gameId]="gameId"
        [roomName]="roomName"
        [playersIndex]="playersIndex"
        [canPullFromPullCard]="canPullFromPullCard"
        [selectedPullCard]="selectedPullCard"
        (hideTheCardAndButton)="hideTheCardAndButton($event)"
        (hideTheButton)="hideButton($event)"
        (changeCanSelectCard)="onCanSelectCardChange($event)"
        (changeCanPullFromTheGround)="onCanPullFromTheGroundChange($event)"
        (showPlayerCard)="showPlayerCard($event)"
        (takeAndGive)="takeAndGiveCard($event)"
        (showFourPlayerCard)="showFourPlayerCard($event)"
        [canPullFromTheGround]="canPullFromTheGround"
        [allTableCards]="tableCards"
        [showTwoCards]="showTwoCards"
        [playerNumber]="playersIndex"
        [updateTheCard]="updateTheCard"
        [takeAndGiveSelectedCard]="takeAndGiveSelectedCard"
        [finishTheRound]="finishTheRound"
      ></app-main-player>
    </div>
    <div class=""></div>
  </div>
</div>
<div class="loaderContainer" *ngIf="roomInfo?.usersId.length != 4">
  <div class="loader"></div>
  <p class="mt-3">Waiting For All Members To Join The Room</p>
</div>
<div class="overlay" *ngIf="!playerCanPlay && canStartTheGame"></div>
<app-game-finished *ngIf="!canStartTheGame"></app-game-finished>
