<div class="row my-3">
  <div class="col-md-9 col-6">
    <app-wait-the-player
      [playerCanPlay]="!playerCanPlay"
      *ngIf="roomInfo?.usersId.length == 4 && canStartTheGame"
    ></app-wait-the-player>
  </div>
  <div class="col-md-2 col-4">
    <app-say-mirror
      *ngIf="canStartTheGame && roomInfo?.usersId.length == 4"
      [gameId]="gameId"
      [roomName]="roomName"
      [playersIndex]="playersIndex"
    ></app-say-mirror>
  </div>
  <div class="col-md-1 col-2" style="z-index: 11">
    <app-results
      *ngIf="roomInfo?.usersId.length == 4"
      [userId]="userId"
      [showGameFinished]="showGameFinished"
      [Results]="showTheResult"
      [playersInfo]="playersInfo"
    ></app-results>
  </div>
</div>

<div class="room-body" *ngIf="roomInfo?.usersId.length == 4 && canStartTheGame">
  <div class="first-line d-flex">
    <app-player
      [playersInfo]="playersInfo"
      *ngIf="
        daynamicPlayer[(playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4]
      "
      [playerCard]="
        daynamicPlayer[(playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4]
          .playerCards
      "
      [playerNumber]="
        daynamicPlayer[(playersIndex + 2) % 4 == 0 ? 4 : (playersIndex + 2) % 4]
          .number
      "
      [gameId]="gameId"
      [roomName]="roomName"
      [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
      [showPlayerCards]="showPlayerCards"
      [takeAndGive]="takeAndGive"
      [showFourPlayerCards]="showFourPlayerCards"
      (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
      (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
      (updateTheCards)="updateTheCards($event)"
      [counterUpdatedForPlayers]="updateCounterForPlayers"
      (updateCounterForPlayers)="updateCounter($event)"
      (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
    ></app-player>
  </div>
  <div class="d-flex">
    <div class="col-md-4 col-sm-4 d-flex justify-content-center">
      <app-player
        [playersInfo]="playersInfo"
        *ngIf="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ]
        "
        [playerCard]="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ].playerCards
        "
        [playerNumber]="
          daynamicPlayer[
            (playersIndex + 3) % 4 == 0 ? 4 : (playersIndex + 3) % 4
          ].number
        "
        [gameId]="gameId"
        [roomName]="roomName"
        [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
        [showPlayerCards]="showPlayerCards"
        [takeAndGive]="takeAndGive"
        [isSmallScreen]="true"
        [showFourPlayerCards]="showFourPlayerCards"
        (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
        (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
        (updateTheCards)="updateTheCards($event)"
        [counterUpdatedForPlayers]="updateCounterForPlayers"
        (updateCounterForPlayers)="updateCounter($event)"
        (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
      ></app-player>
    </div>
    <div class="col-md-4 col-sm-4">
      <div class="row mt-4">
        <div class="col-md-6 col-sm-6">
          <app-table-cards
            [Cards]="tableCards"
            [hideTheButton]="hideTheButton"
            (canPullFromGround)="canPullFromGround($event)"
            [tableCards]="true"
          ></app-table-cards>
        </div>
        <div class="pull-cards col-md-6 col-sm-6">
          <app-pull-cards
            [Cards]="pullCards"
            [allTableCards]="tableCards"
            [gameId]="gameId"
            [roomName]="roomName"
            [hideTheCard]="hideTheCard"
            (canPullFromPullCards)="canPullFromPullCards($event)"
            (takeTheCardWithoutCheck)="takeTheCardWithoutCheckFunction($event)"
            (selectedCard)="theSelectedCard($event)"
          ></app-pull-cards>
        </div>
      </div>
    </div>
    <div class="col-md-4 col-sm-4 d-flex justify-content-center">
      <app-player
        [playersInfo]="playersInfo"
        *ngIf="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ]
        "
        [playerCard]="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ].playerCards
        "
        [playerNumber]="
          daynamicPlayer[
            (playersIndex + 1) % 4 == 0 ? 4 : (playersIndex + 1) % 4
          ].number
        "
        [gameId]="gameId"
        [roomName]="roomName"
        [activePlayerNumber]="activePlayer % 4 == 0 ? 4 : activePlayer % 4"
        [showPlayerCards]="showPlayerCards"
        [takeAndGive]="takeAndGive"
        [isSmallScreen]="true"
        [showFourPlayerCards]="showFourPlayerCards"
        (onShowPlayerCardChange)="onShowPlayerCardChange($event)"
        (onshowFourPlayerCardsChange)="onshowFourPlayerCardChange($event)"
        (updateTheCards)="updateTheCards($event)"
        [counterUpdatedForPlayers]="updateCounterForPlayers"
        (updateCounterForPlayers)="updateCounter($event)"
        (takeAndGiveSelectedCard)="takeAndGiveSelectedCards($event)"
      ></app-player>
    </div>
  </div>
  <div class="first-line d-flex">
    <app-main-player
      [playerName]="playersInfo[playersIndex - 1]?.name"
      [allPullCards]="pullCards"
      [Cards]="playerCards"
      [gameId]="gameId"
      [roomName]="roomName"
      [playersIndex]="playersIndex"
      [canPullFromPullCard]="canPullFromPullCard"
      [takeTheCardWithoutCheck]="takeTheCardWithoutCheck"
      [selectedPullCard]="selectedPullCard"
      (hideTheCardAndButton)="hideTheCardAndButton($event)"
      (hideTheButton)="hideButton($event)"
      (changeCanSelectCard)="onCanSelectCardChange($event)"
      (changeTakeTheCardWithoutCheck)="onchangeTakeTheCardWithoutCheck($event)"
      (changeCanPullFromTheGround)="onCanPullFromTheGroundChange($event)"
      (showPlayerCard)="showPlayerCard($event)"
      (takeAndGive)="takeAndGiveCard($event)"
      (showFourPlayerCard)="showFourPlayerCard($event)"
      [canPullFromTheGround]="canPullFromTheGround"
      [allTableCards]="tableCards"
      [showTwoCards]="showTwoCards"
      [playerNumber]="playersIndex"
      [updateTheCard]="updateTheCard"
      [takeAndGiveSelectedCard]="takeAndGiveSelectedCard"
      [finishTheRound]="finishTheRound"
      [roomPoints]="roomPoints"
    ></app-main-player>
  </div>
</div>

<div
  class="loaderContainer"
  *ngIf="roomInfo?.usersId.length != 4 && canStartTheGame"
>
  <div class="loader"></div>
  <p class="mt-3">Waiting For All Members To Join The Room</p>
</div>
<div class="overlay" *ngIf="!playerCanPlay && canStartTheGame"></div>
